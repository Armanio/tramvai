# Hooks

Хуки необходимы для расширения основного функционала и добавления каких либо действий на разных этапах приложения.

## Как пользоваться

По сути можно разделить на 2 этапа:

1. Мы вставляем в код раннеры хуков, к примеру runAsyncHooks, передавая в него ключ, которые нужно выполнить и параметры дополнительных параметров. У нас теперь есть слот, куда можно добавить хуки и они выполняться, при выполнении кода.
2. Мы регистририум хуки для определенных ключей с помошью registerHooks. После этого, по этому ключу будут доступны хуки для раннеров из пункта 1.

### Особенности

Существует несколько видов хуков и они между собой могут быть не совместимы, по этой причине когда мы регистрируем хуки для ключей, должны проверить как используются и где. Также нужно обязательно сохранять цепочку данных, иначе у нас будут различные баги с потерей данных и несоместимости хуков.

## API

#### Hooks

Создает новый инстанс `hook-runner`.

```javascript
import { Hooks } from '@tinkoff/hook-runner';

const hookRunner = new Hooks();
```

#### registerHooks(key, hooks)

Позволяет зарегистрировать хуки для определенного ключа.

#### runHooks(key, context, payload, options)

Позволяет запустить выполнение обычных хуков, payload проходит через все хуки и вернется как результат.

#### runAsyncHooks(key, context, payload, options)

Позволяет запустить выполнение хуков ассинхронно с помошью setImmediate. Аргумент payload попадет в каждый хук

#### runPromiseHooks(key, context, options) => (payload) => Promise

Позволяет запускать хуки в цепочке промисов. Объект payload должен прокидываться по всей цепочки хуков

## Хуки

### Виды

#### Для промисов

Получает (context, payload, options), мы должны прокидывать по цепочке payload. Нужны для запуска связанных цепочек промисов

#### Для ассинхронных

Получает (context, payload, options), мы асснхронно запускаем хуки. Нужны для запуска несвязанных хуков.

#### Для синхронных

Получает (context, payload, options), мы синхронно запускаем хуки передавая в каждый следующий хук результат прошлого.
