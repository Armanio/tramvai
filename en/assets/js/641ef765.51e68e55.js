(self.webpackChunk=self.webpackChunk||[]).push([[1299],{3905:(e,t,n)=>{"use strict";n.d(t,{Zo:()=>c,kt:()=>m});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),d=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=d(e.components);return i.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=d(n),m=a,h=u["".concat(s,".").concat(m)]||u[m]||p[m]||r;return n?i.createElement(h,o(o({ref:t},c),{},{components:n})):i.createElement(h,o({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var d=2;d<r;d++)o[d]=n[d];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6920:(e,t,n)=>{"use strict";n.r(t),n.d(t,{frontMatter:()=>l,contentTitle:()=>s,metadata:()=>d,toc:()=>c,default:()=>u});var i=n(2122),a=n(9756),r=(n(7294),n(3905)),o=["components"],l={id:"overview",title:"Introduction to tramvai"},s=void 0,d={unversionedId:"concepts/overview",id:"concepts/overview",isDocsHomePage:!1,title:"Introduction to tramvai",description:"tramvai is a lightweight web framework for building SSR applications with a modular system and DI to quickly extend the functionality of applications.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/concepts/overview.md",sourceDirName:"concepts",slug:"/concepts/overview",permalink:"/en/docs/concepts/overview",editUrl:"https://github.com/TinkoffCreditSystems/tramvai/-/edit/master/docs/get-started/overview.md/tmp-docs/concepts/overview.md",version:"current",frontMatter:{id:"overview",title:"Introduction to tramvai"},sidebar:"docs",previous:{title:"Required modules",permalink:"/en/docs/get-started/core-modules"},next:{title:"Dependency Injection",permalink:"/en/docs/concepts/di"}},c=[{value:"Main features",id:"main-features",children:[]},{value:"Approaches used",id:"approaches-used",children:[{value:"Modularity",id:"modularity",children:[]},{value:"Standardization",id:"standardization",children:[]},{value:"Performance",id:"performance",children:[]},{value:"Universal",id:"universal",children:[]},{value:"Splitting into external libraries",id:"splitting-into-external-libraries",children:[]},{value:"DI with interface taken from Nest or Angular DI",id:"di-with-interface-taken-from-nest-or-angular-di",children:[]},{value:"Soft migration option",id:"soft-migration-option",children:[]}]},{value:"Why was it developed",id:"why-was-it-developed",children:[{value:"tramvai",id:"tramvai",children:[]},{value:"@tinkoff/dippy",id:"tinkoffdippy",children:[]},{value:"state",id:"state",children:[]}]},{value:"Concepts",id:"concepts",children:[{value:"Module",id:"module",children:[]},{value:"DI system",id:"di-system",children:[]},{value:"CommandLineRunner",id:"commandlinerunner",children:[]}]},{value:"Diagrams",id:"diagrams",children:[{value:"How it works on the server side",id:"how-it-works-on-the-server-side",children:[]}]}],p={toc:c};function u(e){var t=e.components,l=(0,a.Z)(e,o);return(0,r.kt)("wrapper",(0,i.Z)({},p,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," is a lightweight web framework for building SSR applications with a modular system and DI to quickly extend the functionality of applications."),(0,r.kt)("h2",{id:"main-features"},"Main features"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Modular approach")," - you can extend the functionality of applications using modules"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Universal")," - Works equally well for browsers and server"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\u0411\u044b\u0441\u0442\u0440\u044b\u0439")," - lightweight, does not affect the overall performance of the application, maximizes parallelization of actions on the server")),(0,r.kt)("h2",{id:"approaches-used"},"Approaches used"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"tramvai main",src:n(9126).Z})),(0,r.kt)("h3",{id:"modularity"},"Modularity"),(0,r.kt)("p",null,"The architecture ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," is based on the idea that we have all the functionality divided into various modules and all communication between the modules is based on common interfaces, interacting through ",(0,r.kt)("inlineCode",{parentName:"p"},"DI"),". This architecture makes it possible to easily add new functionality to the application, and replace existing functionality."),(0,r.kt)("h3",{id:"standardization"},"Standardization"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," is a framework that allows you to maintain and create applications with the same architecture for many teams with the ability to share code between projects, as it ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," is a lightweight layer that helps to interact different modules in the application"),(0,r.kt)("h3",{id:"performance"},"Performance"),(0,r.kt)("p",null,"The core ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," together with ",(0,r.kt)("inlineCode",{parentName:"p"},"DI")," weighs 4 kb, everything else is implemented through third-party modules that extend the functionality of the application. This makes it possible to make applications of the minimum size, excluding unnecessary features. The architecture and modules are designed with a concept ",(0,r.kt)("inlineCode",{parentName:"p"},"performance first")," for maximum parallelization, according to best practice."),(0,r.kt)("h3",{id:"universal"},"Universal"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," it is an SSR-first framework and takes into account all the features and problems associated with the server, client and the interaction between them:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"All modules are developed for both the browser and the server"),(0,r.kt)("li",{parentName:"ul"},"Common interfaces are used"),(0,r.kt)("li",{parentName:"ul"},"A ",(0,r.kt)("a",{parentName:"li",href:"/en/docs/concepts/command-line-runner"},"chain of commands")," on the server and the browser is used which allows you to perform actions in determining the lifetime of the application"),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("a",{parentName:"li",href:"/en/docs/concepts/action"},"action system")," allows you to equally request data on the server and in the browser, using various features (e.g. repetition in the browser of an action that crashed on the server)")),(0,r.kt)("h3",{id:"splitting-into-external-libraries"},"Splitting into external libraries"),(0,r.kt)("p",null,"When developing ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," we try to use open source solutions, or create basic libraries that are in no way related to ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," and can be used in other projects and frameworks."),(0,r.kt)("h3",{id:"di-with-interface-taken-from-nest-or-angular-di"},"DI with interface taken from Nest or Angular DI"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"DI")," is the core part of ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," that allows you to reduce code cohesion and separation of functionality into modules. ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," use a library ",(0,r.kt)("inlineCode",{parentName:"p"},"@tinkoff/dippy")," that implements the ",(0,r.kt)("inlineCode",{parentName:"p"},"DI")," container. The internal interface ",(0,r.kt)("inlineCode",{parentName:"p"},"DI")," repeats the interface ",(0,r.kt)("inlineCode",{parentName:"p"},"Nest"),", which allows you to conveniently describe the dependencies and implementations of classes."),(0,r.kt)("h3",{id:"soft-migration-option"},"Soft migration option"),(0,r.kt)("p",null,"A million + lines of code have already been written on ",(0,r.kt)("inlineCode",{parentName:"p"},"tinkoff.ru")," and the new solution should not break the existing code, and also require applications from a difficult and long transition"),(0,r.kt)("h2",{id:"why-was-it-developed"},"Why was it developed"),(0,r.kt)("h3",{id:"tramvai"},"tramvai"),(0,r.kt)("p",null,"Often, React applications are a constructor from different libraries that have been included in the project. This works well on a small scale, but it does not work well for large applications with 70+ developers, since in this approach it is easy to connect your own and disperse radically in the application architecture. This problem is taken over ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," and standardized and implemented by a common application architecture that all product teams use."),(0,r.kt)("p",null,"There are not many open source solutions on github that implement the architecture of large applications."),(0,r.kt)("h4",{id:"alternatives"},"Alternatives"),(0,r.kt)("h5",{id:"nextjs"},"next.js"),(0,r.kt)("p",null,"One of the best simple React frameworks that takes care of server-side rendering and routing. At the same time, this is a lightweight framework that does not standardize in any way and does not solve the problems with the modularity of components. Therefore, most of the code that was written on ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," would have to be written for ",(0,r.kt)("inlineCode",{parentName:"p"},"next.js")," and try to somehow implement, since in ",(0,r.kt)("inlineCode",{parentName:"p"},"next.js")," the ability to extend functionality is very limited"),(0,r.kt)("h5",{id:"fusionjs"},"fusion.js"),(0,r.kt)("p",null,"A similar framework that evolved and emerged at the same time with ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai"),". Fusion.js does not have a full-fledged DI, a limited ability to move functionality into modules and the entire architecture is built on the basis of middlewares, and there are difficulties around the hard-coded priorities of plugins and the lack of parallelization of actions"),(0,r.kt)("h5",{id:"nestjs"},"nest.js"),(0,r.kt)("p",null,"An excellent backend framework that uses similar DI, but is not completely sharpened for SSR. And when using it, we had to have 2 architectures, one for the backend, the other written by ourselves for the client"),(0,r.kt)("h3",{id:"tinkoffdippy"},"@tinkoff/dippy"),(0,r.kt)("p",null,"Lightweight DI library with Angular-like interface. In the open source, there are not so many different DI options that allow you to separate class implementations, both basic general and specific for each client."),(0,r.kt)("h4",{id:"alternatives-1"},"Alternatives"),(0,r.kt)("h5",{id:"inversify"},"inversify"),(0,r.kt)("p",null,"This is the most popular library for creating DI, with:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"weighs 11kb, compared to dippy 1.2kb"),(0,r.kt)("li",{parentName:"ul"},"a low-level API that requires different wrappers to implement a modular system."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ts-nest")," this is an example of a wrapper over inversify that has weak support and only the wrapper contains about the same code as ",(0,r.kt)("inlineCode",{parentName:"li"},"@tinkoff/dippy"))),(0,r.kt)("h3",{id:"state"},"state"),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"/en/docs/features/state/overview"},"state management library")," built into tramvai is almost completely similar to the Redux interface, with few nuances:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Allows you to sign components only for updating certain reducers, solving the problem with performance"),(0,r.kt)("li",{parentName:"ul"},"There is a lot of code written using the deprecated version of the state and you can't just switch to another solution")),(0,r.kt)("h4",{id:"alternatives-2"},"Alternatives"),(0,r.kt)("h5",{id:"redux"},"redux"),(0,r.kt)("p",null,"Moving to pure redux will not solve the problems, it will only add performance-related ones"),(0,r.kt)("h5",{id:"reatom"},"reatom"),(0,r.kt)("p",null,"Very similar to our state manager, a new library that addresses the issue of updates and performance. A good candidate to take some features from. Full transition is very expensive due to the codebase"),(0,r.kt)("h5",{id:"effector"},"effector"),(0,r.kt)("p",null,"Interesting library that has a focus on the client side and is not very suitable for SSR"),(0,r.kt)("h2",{id:"concepts"},"Concepts"),(0,r.kt)("h3",{id:"module"},"Module"),(0,r.kt)("p",null,"The main basic elements of the ",(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," architecture that contain the implementation of functionality. At the same time, it is assumed that such modules will not be huge and a large number of different types will appear."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/en/docs/concepts/module"},"Documentation")),(0,r.kt)("h3",{id:"di-system"},"DI system"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"tramvai")," is built on a DI system that stores the implementation of functionality and receiving implementations for tokens and keys. This allows you to implement communications between modules based only on interfaces, while having the ability to change implementations as needed."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/en/docs/concepts/di"},"Documentation")),(0,r.kt)("h3",{id:"commandlinerunner"},"CommandLineRunner"),(0,r.kt)("p",null,"Runner for a list of actions that modules can attach actions to. There are 2 types of action lists:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Application initialization"),(0,r.kt)("li",{parentName:"ul"},"Processing a request for a client")),(0,r.kt)("p",null,"Within the framework of this list of actions, routes, user status, page rendering and html return to the client are received."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/en/docs/concepts/command-line-runner"},"Documentation")),(0,r.kt)("h2",{id:"diagrams"},"Diagrams"),(0,r.kt)("h3",{id:"how-it-works-on-the-server-side"},"How it works on the server side"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Scheme of the request flow on the server",src:n(5648).Z})))}u.isMDXComponent=!0},5648:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=n.p+"assets/images/arch-server-29e4e39cee3294c25e77c183b07b778c.png"},9126:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=n.p+"assets/images/tramvai-main-39c88cba185dd6017a0849ada565298f.jpg"}}]);