---
id: how-create-async-component
title: Как вынести компонент в асинхронный чанк?
---

tramvai поддерживает вынос компонентов в асинхронные чанки с рендерингом на сервере и гидрацией на клиенте, используя [`@tramvai/react`](features/react.md#lazy)

## Пример компонента

Допустим у нас есть тяжелый React компонент, который изредка используется и мы хотим его грузить только при необходимости. Сейчас у нас такой код:

```tsx
// file heavy.tsx
export const Heavy = () => <div>123</div>;
```

```tsx
// file page.tsx
import Heavy from './heavy.tsx';

const Page = () => (
  <>
    <Heavy />
    <Footer />
  </>
);
```

## Подключаем lazy

Есть несколько способов вынести компонент в асинхронные чанки

- Добавить в `page.tsx` новый враппер для `heavy`.
- Вынести код `heavy` в отдельный файл и в `heavy.tsx` оставить только async враппер

Мы пойдем по пути создания нового файла, так как это позволяет не менять импорты в файлах, которые уже использовали `Heavy` компонент. И в будущем будет сложнее забыть переиспользовать async компонент:

```tsx
// file heavy-component.tsx
export const Heavy = () => <div>123</div>;
```

```tsx
// file heavy.tsx
import { lazy } from '@tramvai/react';

export const Heavy = lazy(() => import('./heavy-component'));
```

```tsx
// file page.tsx
import Heavy from './heavy.tsx';

const Page = () => (
  <>
    <Heavy />
    <Footer />
  </>
);
```

Мы создали новый файл, вынесли туда весь код компонента `Heavy`, а в старом файле оставили только сам компонент, который обернули в `lazy` и заимпортили оригинальный компонент с помощью `import`. Теперь у нас вместо оригинального `Heavy` компонента будет асинхронная версия, которую мы загрузим только при отрисовки `Page` компонента.

## Итог

Компонент `Heavy` будет загружен при необходимости

Дальше компонент будет:

- Автоматически вынесен в отдельный чанк вебпаком
- При отрисовки SSR автоматически загрузит файл и сразу-же отрисует на сервере
- JS и CSS чанка будут вставлены в HTML с максимальным приоритетом
- Браузер бесшовно продолжит работу

[Пример работы в тестовом приложении](how-to/ssr-async-components.md)
